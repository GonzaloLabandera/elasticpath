<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
	<modelVersion>4.0.0</modelVersion>


	<parent>
		<groupId>com.elasticpath.extensions</groupId>
		<artifactId>ext-cortex-ce-parent</artifactId>
		<version>0.0.0-SNAPSHOT</version>
	</parent>

    <groupId>com.elasticpath.extensions.rest.repositories</groupId>
	<artifactId>ext-cortex-repositories</artifactId>
	<packaging>bundle</packaging>

	<name>Extension Cortex CE Repositories </name>
	<description>Elastic Path REST - Extension Resources Integration Commerce Engine Repositories</description>

	<properties>
		<aspectj.compliance.level>1.8</aspectj.compliance.level>
	</properties>

	    <dependencies>
			<!-- Existing EP-Commerce Repositories -->
			<dependency>
				<groupId>com.elasticpath.rest.integration.epcommerce</groupId>
				<artifactId>ep-rest-repositories-epcommerce</artifactId>
			</dependency>

			<dependency>
				<groupId>org.osgi</groupId>
				<artifactId>org.osgi.core</artifactId>
				<version>6.0.0</version>
			</dependency>
			<dependency>
				<groupId>io.reactivex.rxjava2</groupId>
				<artifactId>rxjava</artifactId>
			</dependency>
            <!--Test-->
            <dependency>
                <groupId>junit</groupId>
                <artifactId>junit</artifactId>
                <version>4.11</version>
                <scope>test</scope>
            </dependency>
            <dependency>
                <groupId>org.mockito</groupId>
                <artifactId>mockito-core</artifactId>
                <scope>test</scope>
            </dependency>
        </dependencies>

	<build>
			<plugins>
				<plugin>
					<groupId>org.apache.maven.plugins</groupId>
					<artifactId>maven-dependency-plugin</artifactId>
					<executions>
						<execution>
							<id>unpack</id>
							<phase>generate-sources</phase>
							<goals>
								<goal>unpack</goal>
							</goals>
							<configuration>
								<useBaseVersion>true</useBaseVersion>
								<artifactItems>
									<artifactItem>
										<groupId>com.elasticpath.rest.integration.epcommerce</groupId>
										<artifactId>ep-rest-repositories-epcommerce</artifactId>
										<version>${cortex.ep.integration.version}</version>
										<overWrite>false</overWrite>
										<outputDirectory>${project.build.directory}/wrapped-resources</outputDirectory>
										<includes>**/OSGI-INF/**</includes>
									</artifactItem>
								</artifactItems>
							</configuration>
						</execution>
					</executions>
				</plugin>
				<plugin>
					<groupId>org.apache.felix</groupId>
					<artifactId>maven-bundle-plugin</artifactId>
					<extensions>true</extensions>
					<configuration>
						<rebuildBundle>true</rebuildBundle>
						<instructions>
							<Embed-Directory>lib</Embed-Directory>
							<Embed-Dependency>ep-rest-repositories-epcommerce</Embed-Dependency>
							<Bundle-Activator>
								com.elasticpath.rest.resource.integration.epcommerce.repository.weaving.Activator
							</Bundle-Activator>
							<Import-Package>
								org.aopalliance.aop,
								org.springframework.beans.factory.config,
								org.springframework.context.annotation,
								org.springframework.context.weaving,
								org.aspectj.runtime.internal,
								com.google.common.annotations,
								org.aspectj.runtime.reflect,
								com.elasticpath.rest.id.transform.type,
								com.elasticpath.domain.misc.types,
								com.sun.el,
								*
							</Import-Package>
							<Include-Resource>
								{maven-resources},
								${project.build.directory}/wrapped-resources
							</Include-Resource>
							<_exportcontents>
								com.elasticpath.rest.resource.integration.epcommerce.repository.*,
								com.elasticpath.extensions.rest.resource.integration.epcommerce.repository.*,
							</_exportcontents>
						</instructions>
					</configuration>
				</plugin>
				<plugin>
					<groupId>org.apache.maven.plugins</groupId>
					<artifactId>maven-jar-plugin</artifactId>
					<configuration>
						<archive>
							<manifestEntries>
								<Bundle-Blueprint>classpath:OSGI-INF/blueprint/applicationContext-repositories-integration.xml,classpath:OSGI-INF/blueprint/structuredMessage.xml,classpath:OSGI-INF/blueprint/repositories-integration-blueprint.xml,OSGI-INF/blueprint/ext-applicationContext-repositories-integration.xml,OSGI-INF/blueprint/ext-repositories-integration-blueprint.xml</Bundle-Blueprint>
							</manifestEntries>
						</archive>
					</configuration>
				</plugin>
				<plugin>
					<groupId>org.apache.maven.plugins</groupId>
					<artifactId>maven-checkstyle-plugin</artifactId>
				</plugin>
				<plugin>
					<groupId>org.apache.maven.plugins</groupId>
					<artifactId>maven-pmd-plugin</artifactId>
				</plugin>
			</plugins>

	</build>

</project>
