﻿<?xml version="1.0" encoding="UTF-8"?>
<report xmlns="http://www.eclipse.org/birt/2005/design" version="3.2.23" id="1">
    <property name="comments">Copyright (c) 2006 &lt;&lt;Your Company Name here>></property>
    <property name="createdBy">Eclipse BIRT Designer Version 4.7.0.v201706222054</property>
    <text-property name="title">Shopping Cart Promotion Usage</text-property>
    <property name="units">in</property>
    <property name="layoutPreference">fixed layout</property>
    <list-property name="cssStyleSheets">
        <structure>
            <property name="fileName">cm-modules/cm-plugins/com.elasticpath.cmclient.reporting/css/report.css</property>
            <property name="useExternalCss">false</property>
        </structure>
    </list-property>
    <parameters>
        <scalar-parameter name="store" id="489">
            <text-property name="promptText">store</text-property>
            <property name="valueType">static</property>
            <property name="isRequired">true</property>
            <property name="dataType">string</property>
            <simple-property-list name="defaultValue">
                <value type="constant">""</value>
            </simple-property-list>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="startDate" id="490">
            <text-property name="promptText">startDate</text-property>
            <property name="valueType">static</property>
            <property name="isRequired">false</property>
            <property name="dataType">string</property>
            <property name="controlType">text-box</property>
        </scalar-parameter>
        <scalar-parameter name="endDate" id="491">
            <text-property name="promptText">endDate</text-property>
            <property name="valueType">static</property>
            <property name="isRequired">true</property>
            <property name="dataType">string</property>
            <property name="controlType">text-box</property>
        </scalar-parameter>
    </parameters>
    <data-sources>
        <script-data-source name="EPScriptedDataSource" id="43"/>
    </data-sources>
    <data-sets>
        <script-data-set name="Promotion Usage Dataset" id="660">
            <list-property name="resultSetHints">
                <structure>
                    <property name="position">1</property>
                    <property name="name">Promotion Name</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">2</property>
                    <property name="name">Coupon Usage Type</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">3</property>
                    <property name="name">Store Name</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">4</property>
                    <property name="name">Start Date Time</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">5</property>
                    <property name="name">End Date Time</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">6</property>
                    <property name="name">Number of Orders</property>
                    <property name="dataType">integer</property>
                </structure>
                <structure>
                    <property name="position">7</property>
                    <property name="name">Currency</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">8</property>
                    <property name="name">Total Revenue</property>
                    <property name="dataType">decimal</property>
                </structure>
                <structure>
                    <property name="position">9</property>
                    <property name="name">Percent of Total Orders</property>
                    <property name="dataType">decimal</property>
                </structure>
            </list-property>
            <list-property name="columnHints">
                <structure>
                    <property name="columnName">Promotion Name</property>
                    <text-property name="displayName">Promotion Name</text-property>
                </structure>
                <structure>
                    <property name="columnName">Coupon Usage Type</property>
                    <text-property name="displayName">Coupon Usage Type</text-property>
                </structure>
                <structure>
                    <property name="columnName">Store Name</property>
                    <text-property name="displayName">Store Name</text-property>
                </structure>
                <structure>
                    <property name="columnName">Start Date Time</property>
                    <text-property name="displayName">Start Date Time</text-property>
                </structure>
                <structure>
                    <property name="columnName">End Date Time</property>
                    <text-property name="displayName">End Date Time</text-property>
                </structure>
                <structure>
                    <property name="columnName">Number of Orders</property>
                    <text-property name="displayName">Number of Orders</text-property>
                </structure>
                <structure>
                    <property name="columnName">Currency</property>
                    <text-property name="displayName">Currency</text-property>
                </structure>
                <structure>
                    <property name="columnName">Total Revenue</property>
                    <text-property name="displayName">Total Revenue</text-property>
                </structure>
                <structure>
                    <property name="columnName">Percent of Total Orders</property>
                    <text-property name="displayName">Percent of Total Orders</text-property>
                </structure>
            </list-property>
            <structure name="cachedMetaData">
                <list-property name="resultSet">
                    <structure>
                        <property name="position">1</property>
                        <property name="name">Promotion Name</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">2</property>
                        <property name="name">Coupon Usage Type</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">3</property>
                        <property name="name">Store Name</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">4</property>
                        <property name="name">Start Date Time</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">5</property>
                        <property name="name">End Date Time</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">6</property>
                        <property name="name">Number of Orders</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">7</property>
                        <property name="name">Currency</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">8</property>
                        <property name="name">Total Revenue</property>
                        <property name="dataType">float</property>
                    </structure>
                    <structure>
                        <property name="position">9</property>
                        <property name="name">Percent of Total Orders</property>
                        <property name="dataType">float</property>
                    </structure>
                </list-property>
            </structure>
            <property name="dataSource">EPScriptedDataSource</property>
            <method name="open"><![CDATA[promotionUsageService = new Packages.com.elasticpath.cmclient.reporting.promotionusage.service.impl.PromotionUsageServiceImpl;

promotions = promotionUsageService.getData();

totalRows = promotions.size();

currentRow = 0;]]></method>
            <method name="fetch"><![CDATA[if (currentRow >= totalRows) {
    return false;
}

var promotion = promotions.get(currentRow);

currentRow++;
row["Currency"] = promotion[0];
row["Store Name"] = promotion[1];
row["Promotion Name"] = promotion[3];
row["Coupon Usage Type"] = promotion[4];
row["Start Date Time"] = promotion[5];
row["End Date Time"] = promotion[6];
row["Total Revenue"] = promotion[8];
row["Number of Orders"] = promotion[9];
row["Percent of Total Orders"] = promotion[10];

return true;]]></method>
            <method name="close"><![CDATA[promotionUsageService = null;
promotions = null;

totalRows = null;
currentRow = null;]]></method>
        </script-data-set>
    </data-sets>
    <styles>
        <style name="currency" id="742">
            <property name="paddingRight">6px</property>
            <structure name="numberFormat">
                <property name="category">Currency</property>
                <property name="pattern">#,##0.00 ;(#,##0.00){RoundingMode=HALF_UP}</property>
            </structure>
            <property name="textAlign">right</property>
        </style>
        <style name="percent" id="763">
            <structure name="numberFormat">
                <property name="category">General Number</property>
                <property name="pattern">###0.0  {RoundingMode=HALF_UP}</property>
            </structure>
            <property name="textAlign">right</property>
        </style>
    </styles>
    <page-setup>
        <simple-master-page name="Simple MasterPage" id="2">
            <property name="type">custom</property>
            <property name="orientation">landscape</property>
            <property name="topMargin">0.5in</property>
            <property name="leftMargin">1in</property>
            <property name="bottomMargin">0.5in</property>
            <property name="rightMargin">1in</property>
            <property name="height">11in</property>
            <property name="width">15in</property>
        </simple-master-page>
    </page-setup>
    <body>
        <table id="11">
            <property name="dataSet">Promotion Usage Dataset</property>
            <list-property name="boundDataColumns">
                <structure>
                    <property name="name">Store Name</property>
                    <expression name="expression">dataSetRow["Store Name"]</expression>
                    <property name="dataType">any</property>
                </structure>
                <structure>
                    <property name="name">Currency</property>
                    <expression name="expression">dataSetRow["Currency"]</expression>
                    <property name="dataType">any</property>
                </structure>
                <structure>
                    <property name="name">Promotion Name</property>
                    <expression name="expression">dataSetRow["Promotion Name"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">Total Revenue</property>
                    <expression name="expression">dataSetRow["Total Revenue"]</expression>
                    <property name="dataType">float</property>
                </structure>
                <structure>
                    <property name="name">Number of Orders</property>
                    <expression name="expression">dataSetRow["Number of Orders"]</expression>
                    <property name="dataType">integer</property>
                </structure>
                <structure>
                    <property name="name">Percent of Total Orders</property>
                    <expression name="expression">dataSetRow["Percent of Total Orders"]</expression>
                    <property name="dataType">float</property>
                </structure>
                <structure>
                    <property name="name">Coupon Usage Type</property>
                    <expression name="expression">dataSetRow["Coupon Usage Type"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">Start Date Time</property>
                    <expression name="expression">dataSetRow["Start Date Time"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">End Date Time</property>
                    <expression name="expression">dataSetRow["End Date Time"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">Subtotal: Total Revenue</property>
                    <property name="dataType">float</property>
                    <simple-property-list name="aggregateOn">
                        <value>Currency</value>
                    </simple-property-list>
                    <property name="aggregateFunction">SUM</property>
                    <list-property name="arguments">
                        <structure>
                            <property name="name">Expression</property>
                            <expression name="value" type="javascript">row["Total Revenue"]</expression>
                        </structure>
                    </list-property>
                    <property name="allowExport">false</property>
                </structure>
                <structure>
                    <property name="name">Subtotal: Number of Orders</property>
                    <property name="dataType">float</property>
                    <simple-property-list name="aggregateOn">
                        <value>Currency</value>
                    </simple-property-list>
                    <property name="aggregateFunction">SUM</property>
                    <list-property name="arguments">
                        <structure>
                            <property name="name">Expression</property>
                            <expression name="value" type="javascript">row["Number of Orders"]</expression>
                        </structure>
                    </list-property>
                    <property name="allowExport">false</property>
                </structure>
            </list-property>
            <property name="pageBreakInterval">0</property>
            <column id="710">
                <property name="width">4.0in</property>
            </column>
            <column id="774">
                <property name="width">0.8in</property>
            </column>
            <column id="782">
                <property name="width">0.8in</property>
            </column>
            <column id="790">
                <property name="width">0.8in</property>
            </column>
            <column id="798">
                <property name="width">0.2in</property>
            </column>
            <column id="714">
                <property name="width">1.3in</property>
            </column>
            <column id="718">
                <property name="width">1.4in</property>
            </column>
            <column id="706">
                <property name="width">1.4in</property>
            </column>
            <header>
                <row id="745">
                    <cell id="746">
                        <property name="colSpan">8</property>
                        <property name="rowSpan">1</property>
                        <text id="747">
                            <property name="style">table-header-cell</property>
                            <property name="contentType">html</property>
                            <text-property name="content"><![CDATA[Shopping Cart Promotion Usage Report for <VALUE-OF>params["store"]</VALUE-OF>]]></text-property>
                        </text>
                    </cell>
                </row>
                <row id="748">
                    <cell id="749">
                        <property name="colSpan">8</property>
                        <property name="rowSpan">1</property>
                        <text id="750">
                            <property name="style">table-header-line-2-cell</property>
                            <property name="contentType">html</property>
                            <text-property name="content"><![CDATA[<VALUE-OF>params["startDate"]</VALUE-OF> - <VALUE-OF>params["endDate"]</VALUE-OF>]]></text-property>
                        </text>
                    </cell>
                </row>
            </header>
            <group id="743">
                <property name="groupName">Currency</property>
                <expression name="keyExpr" type="javascript">row["Currency"]</expression>
                <structure name="toc">
                    <expression name="expressionValue" type="javascript">row["Currency"]</expression>
                </structure>
                <property name="hideDetail">false</property>
                <header>
                    <row id="744">
                        <cell id="760">
                            <property name="colSpan">8</property>
                            <property name="rowSpan">1</property>
                            <text-data id="761">
                                <property name="style">table-group-header-emphasis</property>
                                <expression name="valueExpr" type="javascript">"Currency: " + row["Currency"]</expression>
                                <property name="contentType">html</property>
                            </text-data>
                        </cell>
                    </row>
                    <row id="762">
                        <cell id="707">
                            <label id="719">
                                <text-property name="text">Promotion Name</text-property>
                            </label>
                        </cell>
                        <cell id="770">
                            <label id="701">
                                <property name="style">align-right</property>
                                <text-property name="text">Total Revenue</text-property>
                            </label>
                        </cell>
                        <cell id="778">
                            <label id="737">
                                <property name="style">align-right</property>
                                <text-property name="text">Number of Orders</text-property>
                            </label>
                        </cell>
                        <cell id="786">
                            <label id="702">
                                <property name="style">align-right</property>
                                <text-property name="text">% of Total Orders</text-property>
                            </label>
                        </cell>
                        <cell id="794"/>
                        <cell id="711">
                            <label id="720">
                                <text-property name="text">Coupon Usage Type</text-property>
                            </label>
                        </cell>
                        <cell id="715">
                            <label id="721">
                                <text-property name="text">Start Date/Time</text-property>
                            </label>
                        </cell>
                        <cell id="703">
                            <label id="722">
                                <text-property name="text">End Date/Time</text-property>
                            </label>
                        </cell>
                    </row>
                </header>
                <footer>
                    <row id="752">
                        <cell id="753">
                            <text-data id="764">
                                <expression name="valueExpr" type="javascript">"Subtotal: " + row["Currency"]</expression>
                                <property name="contentType">html</property>
                            </text-data>
                        </cell>
                        <cell id="772">
                            <data id="765">
                                <property name="style">currency</property>
                                <property name="resultSetColumn">Subtotal: Total Revenue</property>
                            </data>
                        </cell>
                        <cell id="780">
                            <data id="766">
                                <property name="style">align-right</property>
                                <property name="resultSetColumn">Subtotal: Number of Orders</property>
                            </data>
                        </cell>
                        <cell id="788"/>
                        <cell id="796"/>
                        <cell id="754"/>
                        <cell id="755"/>
                        <cell id="756"/>
                    </row>
                </footer>
            </group>
            <detail>
                <row id="20">
                    <cell id="708">
                        <data id="732">
                            <property name="resultSetColumn">Promotion Name</property>
                        </data>
                    </cell>
                    <cell id="771">
                        <data id="668">
                            <property name="style">currency</property>
                            <property name="resultSetColumn">Total Revenue</property>
                        </data>
                    </cell>
                    <cell id="779">
                        <data id="738">
                            <property name="style">align-right</property>
                            <property name="resultSetColumn">Number of Orders</property>
                        </data>
                    </cell>
                    <cell id="787">
                        <data id="669">
                            <property name="style">percent</property>
                            <property name="resultSetColumn">Percent of Total Orders</property>
                        </data>
                    </cell>
                    <cell id="795"/>
                    <cell id="712">
                        <data id="731">
                            <property name="resultSetColumn">Coupon Usage Type</property>
                        </data>
                    </cell>
                    <cell id="716">
                        <data id="730">
                            <property name="resultSetColumn">Start Date Time</property>
                        </data>
                    </cell>
                    <cell id="704">
                        <data id="729">
                            <property name="resultSetColumn">End Date Time</property>
                        </data>
                    </cell>
                </row>
            </detail>
            <footer>
                <row id="28">
                    <cell id="709"/>
                    <cell id="773"/>
                    <cell id="781"/>
                    <cell id="789"/>
                    <cell id="797"/>
                    <cell id="713"/>
                    <cell id="717"/>
                    <cell id="705"/>
                </row>
            </footer>
        </table>
    </body>
</report>
